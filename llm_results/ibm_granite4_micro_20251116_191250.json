{
  "model": "ibm/granite4:micro",
  "base_url": "http://localhost:11434",
  "timestamp": "2025-11-16T19:12:01.587697",
  "sensitivity": 1.0,
  "migraine_tests": [
    {
      "scenario_name": "Clear LOW - Minimal risk",
      "description": "Perfect weather, no risk factors",
      "weighted_score": 0.0,
      "expected": "LOW",
      "predicted": null,
      "correct": false,
      "confidence": null,
      "rationale": "",
      "analysis": "",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Clear LOW - Minimal risk\nRisk scores: {\"temperature_change\": 0.0, \"humidity_extreme\": 0.0, \"pressure_change\": 0.0, \"pressure_low\": 0.0, \"precipitation\": 0.0, \"cloud_cover\": 0.0, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.00 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 20.0\u00b0C, pressure avg 1013.0hPa, humidity 50%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Clear HIGH - Multiple severe factors",
      "description": "Major pressure drop + large temp change + high humidity",
      "weighted_score": 0.877,
      "expected": "HIGH",
      "predicted": null,
      "correct": false,
      "confidence": null,
      "rationale": "",
      "analysis": "",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Clear HIGH - Multiple severe factors\nRisk scores: {\"temperature_change\": 0.9, \"humidity_extreme\": 0.85, \"pressure_change\": 0.95, \"pressure_low\": 0.8, \"precipitation\": 0.6, \"cloud_cover\": 0.9, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.88 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 8.0\u00b0C, pressure avg 992.0hPa, humidity 92%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Boundary MEDIUM (low end)",
      "description": "Just above LOW threshold (0.40)",
      "weighted_score": 0.42,
      "expected": "MEDIUM",
      "predicted": "MEDIUM",
      "correct": true,
      "confidence": 0.42,
      "rationale": "Weighted score of 0.42 falls in the MEDIUM range (0.4-0.69). Moderate temperature change and humidity extremes contribute to increased risk.",
      "analysis": "Weather shows moderate temperature change, high humidity, and average pressure. These factors suggest a medium risk for migraines today.",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Boundary MEDIUM (low end)\nRisk scores: {\"temperature_change\": 0.4, \"humidity_extreme\": 0.5, \"pressure_change\": 0.5, \"pressure_low\": 0.3, \"precipitation\": 0.2, \"cloud_cover\": 0.4, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.42 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 15.0\u00b0C, pressure avg 1003.0hPa, humidity 72%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Boundary MEDIUM (high end)",
      "description": "Just below HIGH threshold (0.70)",
      "weighted_score": 0.707,
      "expected": "HIGH",
      "predicted": null,
      "correct": false,
      "confidence": null,
      "rationale": "",
      "analysis": "",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Boundary MEDIUM (high end)\nRisk scores: {\"temperature_change\": 0.7, \"humidity_extreme\": 0.75, \"pressure_change\": 0.8, \"pressure_low\": 0.6, \"precipitation\": 0.4, \"cloud_cover\": 0.7, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.71 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 10.0\u00b0C, pressure avg 998.0hPa, humidity 85%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Boundary HIGH (low end)",
      "description": "Just at HIGH threshold (0.70)",
      "weighted_score": 0.772,
      "expected": "HIGH",
      "predicted": "MEDIUM",
      "correct": false,
      "confidence": 0.77,
      "rationale": "Multiple factors exceed thresholds: temperature change (\u22655\u00b0C), extreme humidity (\u226585%), and high pressure drop (\u2264995 hPa). Weighted score indicates moderate risk.",
      "analysis": "Weather shows significant changes with a large temperature range, very high humidity, and low pressure. These conditions increase migraine risk.",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Boundary HIGH (low end)\nRisk scores: {\"temperature_change\": 0.75, \"humidity_extreme\": 0.8, \"pressure_change\": 0.85, \"pressure_low\": 0.7, \"precipitation\": 0.5, \"cloud_cover\": 0.8, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.77 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 7.0\u00b0C, pressure avg 995.0hPa, humidity 88%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "High pressure change only",
      "description": "Single dominant factor (pressure change 30% weight)",
      "weighted_score": 0.39,
      "expected": "LOW",
      "predicted": "MEDIUM",
      "correct": false,
      "confidence": 0.45,
      "rationale": "Weighted score of 0.39 indicates moderate risk due to significant pressure change and high low-pressure factor, but other factors are less impactful.",
      "analysis": "High pressure change (95th percentile) combined with a strong low-pressure system (20% below average) suggests potential for migraines. However, temperature changes and humidity extremes are within moderate ranges.",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: High pressure change only\nRisk scores: {\"temperature_change\": 0.1, \"humidity_extreme\": 0.1, \"pressure_change\": 0.95, \"pressure_low\": 0.2, \"precipitation\": 0.1, \"cloud_cover\": 0.3, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.39 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 18.0\u00b0C, pressure avg 1008.0hPa, humidity 55%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "London example (reported as HIGH)",
      "description": "Real-world case that was misclassified",
      "weighted_score": 0.468,
      "expected": "MEDIUM",
      "predicted": "HIGH",
      "correct": false,
      "confidence": 0.47,
      "rationale": "The weighted score of 0.47 exceeds the HIGH threshold (\u22650.7) when considering multiple factors: pressure change and low pressure are significant, while humidity extremes also contribute to risk.",
      "analysis": "High-pressure system with moderate temperature stability and high humidity increase migraine risk in London today.",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: London example (reported as HIGH)\nRisk scores: {\"cloud_cover\": 1.0, \"humidity_extreme\": 0.53, \"precipitation\": 0.18, \"pressure_change\": 0.71, \"pressure_low\": 0.26, \"temperature_change\": 0.11, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.47 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 12.9\u00b0C, pressure avg 1001.2hPa, humidity 84%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Thessaloniki example (reported as HIGH)",
      "description": "Real-world case with weighted score 0.36",
      "weighted_score": 0.376,
      "expected": "LOW",
      "predicted": null,
      "correct": false,
      "confidence": null,
      "rationale": "",
      "analysis": "",
      "adjusted_thresholds": {
        "high": 0.7,
        "medium": 0.4
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a migraine risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON.\n\nMIGRAINE TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% or \u226430% is moderate risk, \u226585% or \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk, \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights):\n- Pressure change: 30% (most important - rapid pressure changes are the strongest migraine trigger)\n- Temperature change: 25% (rapid temperature swings trigger migraines)\n- Low pressure: 15% (low pressure systems increase migraine risk)\n- Humidity extremes: 15% (very high or very low humidity)\n- Cloud cover: 10% (overcast conditions affect some people)\n- Precipitation: 5% (rain and storms can contribute)\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (pressure drops, temperature swings) are more important than absolute values\n- Changes can be positive (+) or negative (-), indicating direction of change\n- Consider both the magnitude of changes AND the min/max ranges provided\n- Large ranges (e.g., temperature_range, pressure_range) indicate weather instability\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Thessaloniki example (reported as HIGH)\nRisk scores: {\"cloud_cover\": 1.0, \"humidity_extreme\": 0.81, \"precipitation\": 0.42, \"pressure_change\": 0.41, \"pressure_low\": 0.0, \"temperature_change\": 0.04, \"weights\": {\"temperature_change\": 0.25, \"humidity_extreme\": 0.15, \"pressure_change\": 0.3, \"pressure_low\": 0.15, \"precipitation\": 0.05, \"cloud_cover\": 0.1}}\nWeighted score: 0.38 (LOW<0.40, MEDIUM:0.40-0.69, HIGH\u22650.70)\nWeather: temp avg 15.5\u00b0C, pressure avg 1010.2hPa, humidity 94%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    }
  ],
  "sinusitis_tests": [
    {
      "scenario_name": "Clear LOW - Minimal risk",
      "description": "Perfect weather for sinuses",
      "weighted_score": 0.0,
      "expected": "LOW",
      "predicted": "LOW",
      "correct": true,
      "confidence": 1.0,
      "rationale": "No significant weather changes or extreme conditions detected that would increase sinusitis risk.",
      "analysis": "Clear skies and stable pressure with moderate humidity indicate minimal risk of sinusitis triggers in the current weather pattern.",
      "adjusted_thresholds": {
        "high": 0.65,
        "medium": 0.35
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a sinusitis risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON. Focus on sinusitis triggers: rapid temperature changes, humidity extremes (high promotes allergens/mold, low dries sinuses), barometric pressure changes, and precipitation (increases allergens).\n\nSINUSITIS TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% is moderate risk (promotes mold/allergens), \u226585% is high risk\n- Humidity: \u226430% is moderate risk (dries sinuses), \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk (increases allergens), \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights for sinusitis):\n- Temperature change: 30% (most important for sinusitis)\n- Humidity extremes: 25% (very important - affects allergens/mold and sinus dryness)\n- Pressure change: 20%\n- Precipitation: 10% (increases allergens)\n- Low pressure: 10%\n- Cloud cover: 5%\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (humidity swings, temperature changes) are more important than absolute values\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Clear LOW - Minimal risk\nRisk scores: {\"temperature_change\": 0.0, \"humidity_extreme\": 0.0, \"pressure_change\": 0.0, \"pressure_low\": 0.0, \"precipitation\": 0.0, \"cloud_cover\": 0.0, \"weights\": {\"temperature_change\": 0.3, \"humidity_extreme\": 0.25, \"pressure_change\": 0.2, \"pressure_low\": 0.1, \"precipitation\": 0.1, \"cloud_cover\": 0.05}}\nWeighted score: 0.00 (LOW<0.35, MEDIUM:0.35-0.64, HIGH\u22650.65)\nWeather: pressure avg 1013.0hPa, humidity 50%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Clear HIGH - Humidity and temp change",
      "description": "High humidity + temperature change (key sinusitis triggers)",
      "weighted_score": 0.808,
      "expected": "HIGH",
      "predicted": "HIGH",
      "correct": true,
      "confidence": 0.85,
      "rationale": "Significant temperature change (moderate risk) and extreme humidity (high risk) indicate high sinusitis risk due to rapid shifts promoting mold/allergens and drying sinuses.",
      "analysis": "Clear skies with low pressure, high humidity (>90%), and moderate temperature changes create ideal conditions for sinusitis. The combination of humidity extremes and pressure drops significantly increases the likelihood of sinus issues.",
      "adjusted_thresholds": {
        "high": 0.65,
        "medium": 0.35
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a sinusitis risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON. Focus on sinusitis triggers: rapid temperature changes, humidity extremes (high promotes allergens/mold, low dries sinuses), barometric pressure changes, and precipitation (increases allergens).\n\nSINUSITIS TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% is moderate risk (promotes mold/allergens), \u226585% is high risk\n- Humidity: \u226430% is moderate risk (dries sinuses), \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk (increases allergens), \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights for sinusitis):\n- Temperature change: 30% (most important for sinusitis)\n- Humidity extremes: 25% (very important - affects allergens/mold and sinus dryness)\n- Pressure change: 20%\n- Precipitation: 10% (increases allergens)\n- Low pressure: 10%\n- Cloud cover: 5%\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (humidity swings, temperature changes) are more important than absolute values\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Clear HIGH - Humidity and temp change\nRisk scores: {\"temperature_change\": 0.9, \"humidity_extreme\": 0.95, \"pressure_change\": 0.7, \"pressure_low\": 0.5, \"precipitation\": 0.8, \"cloud_cover\": 0.6, \"weights\": {\"temperature_change\": 0.3, \"humidity_extreme\": 0.25, \"pressure_change\": 0.2, \"pressure_low\": 0.1, \"precipitation\": 0.1, \"cloud_cover\": 0.05}}\nWeighted score: 0.81 (LOW<0.35, MEDIUM:0.35-0.64, HIGH\u22650.65)\nWeather: pressure avg 998.0hPa, humidity 92%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    },
    {
      "scenario_name": "Boundary MEDIUM (sinusitis)",
      "description": "Just above LOW threshold (0.35)",
      "weighted_score": 0.365,
      "expected": "MEDIUM",
      "predicted": "MEDIUM",
      "correct": true,
      "confidence": 0.6,
      "rationale": "Weighted score of 0.36 indicates a medium risk for sinusitis due to moderate temperature change and high humidity levels promoting allergens/mold.",
      "analysis": "The weather shows a pressure average of 1002 hPa (moderate), with humidity at 75% (moderate risk for mold/allergens). Temperature changes are moderate, leading to a weighted score placing the overall risk in the medium range. No other factors suggest high risk.",
      "adjusted_thresholds": {
        "high": 0.65,
        "medium": 0.35
      },
      "request_payload": {
        "model": "ibm/granite4:micro",
        "messages": [
          {
            "role": "system",
            "content": "You are a sinusitis risk assessor. Analyze weather conditions and output ONLY valid JSON matching the schema below. Do not include any text before or after the JSON. Focus on sinusitis triggers: rapid temperature changes, humidity extremes (high promotes allergens/mold, low dries sinuses), barometric pressure changes, and precipitation (increases allergens).\n\nSINUSITIS TRIGGER THRESHOLDS:\n- Temperature change: \u22655\u00b0C is moderate risk, \u226510\u00b0C is high risk\n- Humidity: \u226570% is moderate risk (promotes mold/allergens), \u226585% is high risk\n- Humidity: \u226430% is moderate risk (dries sinuses), \u226420% is high risk\n- Humidity change: \u226510 percentage points is moderate risk, \u226520 is high risk\n- Pressure change: \u22655 hPa is moderate risk, \u226510 hPa is high risk\n- Low pressure: <1005 hPa is moderate risk, <995 hPa is high risk\n- Precipitation: \u22655mm is moderate risk (increases allergens), \u226510mm is high risk\n- Cloud cover: \u226580% is moderate risk, \u226595% is high risk\n\nRISK FACTOR IMPORTANCE (weights for sinusitis):\n- Temperature change: 30% (most important for sinusitis)\n- Humidity extremes: 25% (very important - affects allergens/mold and sinus dryness)\n- Pressure change: 20%\n- Precipitation: 10% (increases allergens)\n- Low pressure: 10%\n- Cloud cover: 5%\n\nCLASSIFICATION GUIDELINES:\n- Use the weighted score provided as a starting point\n- LOW: weighted score < 0.4 (most predictions should be LOW)\n- MEDIUM: weighted score 0.4-0.69\n- HIGH: weighted score \u2265 0.7 (only when multiple high-weight factors exceed thresholds)\n- Focus on ACTUAL WEATHER VALUES and CHANGES, not normalized scores\n- Weather CHANGES (humidity swings, temperature changes) are more important than absolute values\n- Previous predictions are for context only - do not blindly follow patterns\n- Be conservative: only predict HIGH when there's clear evidence of multiple risk factors\n\n<schema>\n{\n  \"probability_level\": \"LOW\" | \"MEDIUM\" | \"HIGH\",\n  \"confidence\": <float between 0 and 1>,\n  \"rationale\": \"<brief explanation>\",\n  \"analysis_text\": \"<concise user explanation>\",\n  \"prevention_tips\": [\"<tip1>\", \"<tip2>\", ...]\n}\n</schema>"
          },
          {
            "role": "user",
            "content": "Location: Test: Boundary MEDIUM (sinusitis)\nRisk scores: {\"temperature_change\": 0.4, \"humidity_extreme\": 0.5, \"pressure_change\": 0.3, \"pressure_low\": 0.2, \"precipitation\": 0.3, \"cloud_cover\": 0.2, \"weights\": {\"temperature_change\": 0.3, \"humidity_extreme\": 0.25, \"pressure_change\": 0.2, \"pressure_low\": 0.1, \"precipitation\": 0.1, \"cloud_cover\": 0.05}}\nWeighted score: 0.36 (LOW<0.35, MEDIUM:0.35-0.64, HIGH\u22650.65)\nWeather: pressure avg 1002.0hPa, humidity 75%"
          }
        ],
        "temperature": 0.2
      },
      "error": null
    }
  ],
  "summary": {
    "migraine_accuracy": 0.125,
    "migraine_correct": 1,
    "migraine_total": 8,
    "migraine_errors": 0,
    "sinusitis_accuracy": 1.0,
    "sinusitis_correct": 3,
    "sinusitis_total": 3,
    "sinusitis_errors": 0,
    "overall_accuracy": 0.36363636363636365,
    "total_correct": 4,
    "total_tests": 11,
    "total_errors": 0
  }
}